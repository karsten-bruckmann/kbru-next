<ion-modal [isOpen]="open">
  <ng-template>
    <ng-container *ngIf="players$ | async as players">
      <ng-container *ngIf="form$ | async as form" [formGroup]="form">
        <ion-header>
          <ion-toolbar color="primary">
            <ion-title>Spiel eintragen</ion-title>
            <ion-buttons slot="end">
              <ion-button (click)="open = false">
                <ion-icon name="close"></ion-icon>
              </ion-button>
            </ion-buttons>
          </ion-toolbar>
        </ion-header>
        <ion-content>
          <ion-list inset *ngIf="form.controls.playerId">
            <ion-item-divider color="primary">
              <ion-label>Spieler</ion-label>
            </ion-item-divider>
            <ion-item color="light" *ngIf="form.controls.playerId">
              <ion-label>Spieler</ion-label>
              <ion-select interface="popover" formControlName="playerId">
                <ion-select-option
                  *ngFor="let value of form.controls.playerId.possibleValues"
                  [value]="value"
                  >{{ playerName(value, players) }}</ion-select-option
                >
              </ion-select>
            </ion-item>
          </ion-list>
        </ion-content>

        <ion-footer>
          <ion-list inset>
            <ion-button
              expand="block"
              [disabled]="form.invalid"
              (click)="submit(form)"
              >Spiel eintragen</ion-button
            >
            <ion-accordion-group>
              <ion-accordion>
                <ion-item slot="header">
                  <ion-label>debug</ion-label>
                </ion-item>
                <ion-item slot="content">
                  <pre>{{ form.skatGame | json }}</pre>
                </ion-item>
                <ion-item slot="content">
                  <pre>{{ form.value | json }}</pre>
                </ion-item>
                <ion-item slot="content">
                  <pre>{{ fieldErrors(form) | json }}</pre>
                </ion-item>
              </ion-accordion>
            </ion-accordion-group>
          </ion-list>
        </ion-footer>
      </ng-container>
    </ng-container>
  </ng-template>
</ion-modal>

<ion-modal [isOpen]="open">
  <ng-template>
    <ng-container *ngIf="list$ | async as list">
      <ng-container *ngIf="form$ | async as form" [formGroup]="form">
        <ion-header>
          <ion-toolbar color="primary">
            <ion-title>Spiel eintragen</ion-title>
            <ion-buttons slot="end">
              <ion-button (click)="open = false">
                <ion-icon name="close"></ion-icon>
              </ion-button>
            </ion-buttons>
          </ion-toolbar>
        </ion-header>
        <ion-content>
          <ion-list inset *ngIf="form.controls.playerIndex">
            <ion-item-divider color="primary">
              <ion-label>Spieler</ion-label>
            </ion-item-divider>
            <ion-item color="light" *ngIf="form.controls.playerIndex">
              <ion-label>Spieler</ion-label>
              <ion-select interface="popover" formControlName="playerIndex">
                <ion-select-option
                  *ngFor="let value of form.controls.playerIndex.possibleValues"
                  [value]="value"
                  >{{
                    form.controls.playerIndex.names[value]
                  }}</ion-select-option
                >
              </ion-select>
            </ion-item>
          </ion-list>

          <ion-list inset *ngIf="form.controls.gameType">
            <ion-item-divider color="primary">
              <ion-label>Spiel</ion-label>
            </ion-item-divider>
            <ion-item color="light" *ngIf="form.controls.gameType">
              <ion-label>Spiel</ion-label>
              <ion-select interface="popover" formControlName="gameType">
                <ion-select-option
                  *ngFor="let value of form.controls.gameType.possibleValues"
                  [value]="value"
                  >{{ value }}</ion-select-option
                >
              </ion-select>
            </ion-item>
            <ion-item color="light" *ngIf="form.controls.spitzen">
              <ion-label>Spitzen</ion-label>
              <ion-select interface="popover" formControlName="spitzen">
                <ion-select-option
                  *ngFor="let value of form.controls.spitzen.possibleValues"
                  [value]="value"
                  >{{ value }}</ion-select-option
                >
              </ion-select>
            </ion-item>
            <ion-item color="light" *ngIf="form.controls.nullGameType">
              <ion-label>Null</ion-label>
              <ion-select interface="popover" formControlName="nullGameType">
                <ion-select-option
                  *ngFor="
                    let value of form.controls.nullGameType.possibleValues
                  "
                  [value]="value"
                  >{{ value }}</ion-select-option
                >
              </ion-select>
            </ion-item>
            <ion-item color="light" *ngIf="form.controls.hand">
              <ion-label>Hand</ion-label>
              <ion-toggle formControlName="hand"></ion-toggle>
            </ion-item>
            <ion-item color="light" *ngIf="form.controls.threshold">
              <ion-label>Gespielt</ion-label>
              <ion-select interface="popover" formControlName="threshold">
                <ion-select-option
                  *ngFor="let value of form.controls.threshold.possibleValues"
                  [value]="value"
                  >{{ value }}</ion-select-option
                >
              </ion-select>
            </ion-item>
            <ion-item color="light" *ngIf="form.controls.thresholdAnnounced">
              <ion-label>Angesagt</ion-label>
              <ion-select
                interface="popover"
                formControlName="thresholdAnnounced"
              >
                <ion-select-option
                  *ngFor="
                    let value of form.controls.thresholdAnnounced.possibleValues
                  "
                  [value]="value"
                  >{{ value }}</ion-select-option
                >
              </ion-select>
            </ion-item>
            <ion-item color="light" *ngIf="form.controls.spritze">
              <ion-label>Spritze</ion-label>
              <ion-select interface="popover" formControlName="spritze">
                <ion-select-option
                  *ngFor="let value of form.controls.spritze.possibleValues"
                  [value]="value"
                  >{{ value }}</ion-select-option
                >
              </ion-select>
            </ion-item>
          </ion-list>
        </ion-content>

        <ion-footer>
          <ion-list inset>
            <ion-button
              expand="block"
              [disabled]="form.invalid"
              (click)="submit(form)"
              >Spiel eintragen</ion-button
            >
            <ion-accordion-group>
              <ion-accordion>
                <ion-item slot="header">
                  <ion-label>debug</ion-label>
                </ion-item>
                <ion-item slot="content">
                  <!-- <pre>{{ form.game | json }}</pre> -->
                </ion-item>
                <ion-item slot="content">
                  <pre>{{ form.value | json }}</pre>
                </ion-item>
                <ion-item slot="content">
                  <pre>{{ fieldErrors(form) | json }}</pre>
                </ion-item>
              </ion-accordion>
            </ion-accordion-group>
          </ion-list>
        </ion-footer>
      </ng-container>
    </ng-container>
  </ng-template>
</ion-modal>
